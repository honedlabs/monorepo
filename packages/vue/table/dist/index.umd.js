(function(x,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue"),require("@inertiajs/vue3"),require("axios")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3","axios"],u):(x=typeof globalThis<"u"?globalThis:x||self,u(x["@honed/table"]={},x.Vue,x.Inertia,x.axios))})(this,function(x,u,b,Y){"use strict";function H(a,m={},s={}){if(!a.href||!a.method)return!1;if(a.type==="inertia")a.method==="delete"?b.router.delete(a.href,s):b.router[a.method](a.href,m,s);else{const i=v=>{var c;return(c=s.onError)==null?void 0:c.call(s,v)};a.method==="get"?window.location.href=a.href:a.method==="delete"?Y.delete(a.href).catch(i):Y[a.method](a.href,m).catch(i)}return!0}function Z(){const a=u.ref({all:!1,only:new Set,except:new Set});function m(){a.value.all=!0,a.value.only.clear(),a.value.except.clear()}function s(){a.value.all=!1,a.value.only.clear(),a.value.except.clear()}function i(...p){p.forEach(h=>a.value.except.delete(h)),p.forEach(h=>a.value.only.add(h))}function v(...p){p.forEach(h=>a.value.except.add(h)),p.forEach(h=>a.value.only.delete(h))}function c(p,h){if(d(p)||h===!1)return v(p);if(!d(p)||h===!0)return i(p)}function d(p){return a.value.all?!a.value.except.has(p):a.value.only.has(p)}const l=u.computed(()=>a.value.all&&a.value.except.size===0),w=u.computed(()=>a.value.only.size>0||l.value);function k(p){return{"onUpdate:modelValue":h=>{h?i(p):v(p)},modelValue:d(p),value:p}}function _(){return{"onUpdate:modelValue":p=>{p?m():s()},modelValue:l.value}}return{allSelected:l,selection:a,hasSelected:w,selectAll:m,deselectAll:s,select:i,deselect:v,toggle:c,selected:d,bind:k,bindAll:_}}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Q=()=>{};function ee(a,m){function s(...i){return new Promise((v,c)=>{Promise.resolve(a(()=>m.apply(this,i),{fn:m,thisArg:this,args:i})).then(v).catch(c)})}return s}function te(a,m={}){let s,i,v=Q;const c=l=>{clearTimeout(l),v(),v=Q};let d;return l=>{const w=u.toValue(a),k=u.toValue(m.maxWait);return s&&c(s),w<=0||k!==void 0&&k<=0?(i&&(c(i),i=null),Promise.resolve(l())):new Promise((_,p)=>{v=m.rejectOnCancel?p:_,d=l,k&&!i&&(i=setTimeout(()=>{s&&c(s),i=null,_(d())},k)),s=setTimeout(()=>{i&&c(i),i=null,_(l())},w)})}}function z(a,m=200,s={}){return ee(te(m,s),a)}function ne(a,m,s={}){if(!(a!=null&&a[m]))throw new Error("The refine must be provided with valid props and key.");const i=u.computed(()=>a[m]),v=u.computed(()=>!!i.value._sort_key),c=u.computed(()=>!!i.value._search_key),d=u.computed(()=>!!i.value._match_key),l=u.computed(()=>{var t;return(t=i.value.filters)==null?void 0:t.map(n=>({...n,apply:(o,e={})=>F(n,o,e),clear:(o={})=>U(n,o),bind:()=>q(n.name)}))}),w=u.computed(()=>{var t;return(t=i.value.sorts)==null?void 0:t.map(n=>({...n,apply:(o={})=>g(n,n.direction,o),clear:(o={})=>C(o),bind:()=>W(n)}))}),k=u.computed(()=>{var t;return(t=i.value.searches)==null?void 0:t.map(n=>({...n,apply:(o={})=>M(n,o),clear:(o={})=>M(n,o),bind:()=>K(n)}))}),_=u.computed(()=>l.value.filter(({active:t})=>t)),p=u.computed(()=>w.value.find(({active:t})=>t)),h=u.computed(()=>k.value.filter(({active:t})=>t));function E(t){return Array.isArray(t)?t.join(i.value._delimiter):t}function L(t){return typeof t!="string"?t:t.trim().replace(/\s+/g,"+")}function A(t){if(!["",null,void 0,[]].includes(t))return t}function B(t){return[E,L,A].reduce((n,o)=>o(n),t)}function D(t,n){return n=Array.isArray(n)?n:[n],n.includes(t)?n.filter(o=>o!==t):[...n,t]}function j(t){return typeof t!="string"?t:l.value.find(({name:n})=>n===t)}function R(t,n=null){return typeof t!="string"?t:w.value.find(({name:o,direction:e})=>o===t&&e===n)}function $(t){return typeof t!="string"?t:k.value.find(({name:n})=>n===t)}function J(t){return t?typeof t=="string"?_.value.some(n=>n.name===t):t.active:!!_.value.length}function N(t){var n;return t?typeof t=="string"?((n=p.value)==null?void 0:n.name)===t:t.active:!!p.value}function y(t){var n;return t?typeof t=="string"?(n=h.value)==null?void 0:n.some(o=>o.name===t):t.active:!!i.value.term}function G(t,n={}){const o=Object.fromEntries(Object.entries(t).map(([e,r])=>[e,B(r)]));b.router.reload({...s,...n,data:o})}function F(t,n,o={}){const e=j(t);if(!e)return console.warn(`Filter [${t}] does not exist.`);b.router.reload({...s,...o,data:{[e.name]:B(n)}})}function g(t,n=null,o={}){if(!v.value)return console.warn("Refine cannot perform sorting.");const e=R(t,n);if(!e)return console.warn(`Sort [${t}] does not exist.`);b.router.reload({...s,...o,data:{[i.value._sort_key]:A(e.next)}})}function V(t,n={}){if(!c.value)return console.warn("Refine cannot perform searching.");t=[L,A].reduce((o,e)=>e(o),t),b.router.reload({...s,...n,data:{[i.value._search_key]:t}})}function M(t,n={}){if(!d.value||!c.value)return console.warn("Refine cannot perform matching.");const o=$(t);if(!o)return console.warn(`Match [${t}] does not exist.`);const e=D(o.name,h.value.map(({name:r})=>r));b.router.reload({...s,...n,data:{[i.value._match_key]:E(e)}})}function U(t,n={}){if(t)return F(t,null,n);b.router.reload({...s,...n,data:Object.fromEntries(_.value.map(({name:o})=>[o,null]))})}function C(t={}){if(!v.value)return console.warn("Refine cannot perform sorting.");b.router.reload({...s,...t,data:{[i.value._sort_key]:null}})}function I(t={}){V(null,t)}function P(t={}){if(!d.value)return console.warn("Refine cannot perform matching.");b.router.reload({...s,...t,data:{[i.value._match_key]:null}})}function O(t={}){var n;b.router.reload({...s,...t,data:{[i.value._search_key??""]:void 0,[i.value._sort_key??""]:void 0,[i.value._match_key??""]:void 0,...Object.fromEntries(((n=i.value.filters)==null?void 0:n.map(o=>[o.name,void 0]))??[])}})}function q(t,n={}){const o=j(t);if(!o)return console.warn(`Filter [${t}] does not exist.`);const{debounce:e=150,transform:r=S=>S,...f}=n;return{"onUpdate:modelValue":z(S=>{F(o,r(S),f)},e),modelValue:o.value}}function W(t,n={}){if(!v.value)return console.warn("Refine cannot perform sorting.");const o=R(t);if(!o)return console.warn(`Sort [${t}] does not exist.`);const{debounce:e=0,transform:r,...f}=n;return{onClick:z(()=>{var S;g(o,(S=p.value)==null?void 0:S.direction,f)},e)}}function X(t={}){if(!c.value)return console.warn("Refine cannot perform searching.");const{debounce:n=700,transform:o,...e}=t;return{"onUpdate:modelValue":z(r=>{V(r,e)},n),modelValue:i.value.term??""}}function K(t,n={}){if(!d.value)return console.warn("Refine cannot perform matching.");const o=$(t);if(!o)return console.warn(`Match [${t}] does not exist.`);const{debounce:e=0,transform:r,...f}=n;return{"onUpdate:modelValue":z(S=>{M(S,f)},e),modelValue:y(o),value:o.name}}return u.reactive({filters:l,sorts:w,searches:k,currentFilters:_,currentSort:p,currentSearches:h,isSortable:v,isSearchable:c,isMatchable:d,isFiltering:J,isSorting:N,isSearching:y,getFilter:j,getSort:R,getSearch:$,apply:G,applyFilter:F,applySort:g,applySearch:V,applyMatch:M,clearFilter:U,clearSort:C,clearSearch:I,clearMatch:P,reset:O,bindFilter:q,bindSort:W,bindSearch:X,bindMatch:K,stringValue:L,omitValue:A,toggleValue:D,delimitArray:E})}function re(a,m,s={}){if(!(a!=null&&a[m]))throw new Error("The table must be provided with valid props and key.");const{recordOperations:i={},...v}={only:[...s.only??[],m.toString()],...s},c=u.computed(()=>a[m]),d=Z(),l=ne(a,m,v),w=u.computed(()=>c.value.meta),k=u.computed(()=>c.value.views??[]),_=u.computed(()=>c.value.state??null),p=u.computed(()=>c.value.placeholder??null),h=u.computed(()=>!!c.value.state),E=u.computed(()=>!!c.value._page_key&&!!c.value._record_key),L=u.computed(()=>!!c.value._column_key),A=u.computed(()=>c.value.columns.filter(({active:e,hidden:r})=>e&&!r).map(e=>{var r;return{...e,isSorting:!!((r=e.sort)!=null&&r.active),toggleSort:(f={})=>l.applySort(e.sort,null,f)}})),B=u.computed(()=>c.value.columns.filter(({hidden:e})=>!e).map(e=>({...e,toggle:(r={})=>K(e.name,r)}))),D=u.computed(()=>c.value.records.map(e=>({...e,operations:e.operations.map(r=>({...r,execute:(f={})=>O(r,e,f)})),selected:d.selected(g(e)),default:(r={})=>{const f=e.operations.find(({default:S})=>S);f&&O(f,e,r)},select:()=>d.select(g(e)),deselect:()=>d.deselect(g(e)),toggle:()=>d.toggle(g(e)),bind:()=>d.bind(g(e)),entry:r=>V(e,r),value:r=>M(e,r),extra:r=>U(e,r)}))),j=u.computed(()=>!!c.value.operations.inline),R=u.computed(()=>c.value.operations.bulk.map(e=>({...e,execute:(r={})=>q(e,r)}))),$=u.computed(()=>c.value.operations.page.map(e=>({...e,execute:(r={})=>W(e,r)}))),J=u.computed(()=>c.value.pages.find(({active:e})=>e)),N=u.computed(()=>c.value.pages),y=u.computed(()=>({...c.value.paginate,next:(e={})=>{"nextLink"in y.value&&y.value.nextLink&&P(y.value.nextLink,e)},previous:(e={})=>{"prevLink"in y.value&&y.value.prevLink&&P(y.value.prevLink,e)},first:(e={})=>{"firstLink"in y.value&&y.value.firstLink&&P(y.value.firstLink,e)},last:(e={})=>{"lastLink"in y.value&&y.value.lastLink&&P(y.value.lastLink,e)},..."links"in c.value.paginate&&c.value.paginate.links?{links:c.value.paginate.links.map(e=>({...e,navigate:(r={})=>e.url&&P(e.url,r)}))}:{}})),G=u.computed(()=>c.value.records.length>0&&c.value.records.every(e=>d.selected(g(e))));function F(e){return typeof e=="string"?e:e.name}function g(e){return e._key}function V(e,r){const f=F(r);return e[f]}function M(e,r){var f;return((f=V(e,r))==null?void 0:f.v)??null}function U(e,r){var f;return(f=V(e,r))==null?void 0:f.e}function C(e){return{id:g(e)}}function I(){return{all:d.selection.value.all,only:Array.from(d.selection.value.only),except:Array.from(d.selection.value.except)}}function P(e,r={}){b.router.visit(e,{preserveScroll:!0,preserveState:!0,...v,...r,method:"get"})}function O(e,r,f={}){var T;H(e,C(r),{...s,...f})||(T=i==null?void 0:i[e.name])==null||T.call(i,r)}function q(e,r={}){return H(e,I(),{...s,...r,onSuccess:f=>{var S,T;(S=r.onSuccess)==null||S.call(r,f),(T=s.onSuccess)==null||T.call(s,f),e.keep||d.deselectAll()}})}function W(e,r={},f={}){return H(e,r,{...s,...f})}function X(e,r={}){if(!E.value)return console.warn("The table does not support pagination changes.");b.router.reload({...v,...r,data:{[c.value._record_key]:e.value,[c.value._page_key]:void 0}})}function K(e,r={}){if(!L.value)return console.warn("The table does not support column toggling.");const f=F(e);if(!f)return console.log(`Column [${e}] does not exist.`);const S=l.toggleValue(f,A.value.map(({name:T})=>T));b.router.reload({...v,...r,data:{[c.value._column_key]:l.delimitArray(S)}})}function t(){d.select(...c.value.records.map(e=>g(e)))}function n(){d.deselect(...c.value.records.map(e=>g(e)))}function o(){return{"onUpdate:modelValue":e=>{e?t():n()},modelValue:G.value}}return u.reactive({meta:w,views:k,emptyState:_,placeholder:p,isEmpty:h,isPageable:E,isToggleable:L,getEntry:V,getValue:M,getExtra:U,getRecordKey:g,headings:A,columns:B,records:D,inline:j,bulk:R,page:$,pages:N,currentPage:J,paginator:y,executeInline:O,executeBulk:q,executePage:W,getBulkData:I,getRecordData:C,applyPage:X,selection:d.selection,select:e=>d.select(g(e)),deselect:e=>d.deselect(g(e)),selectPage:t,deselectPage:n,toggle:e=>d.toggle(g(e)),selected:e=>d.selected(g(e)),selectAll:d.selectAll,deselectAll:d.deselectAll,isPageSelected:G,hasSelected:d.hasSelected,bindCheckbox:e=>d.bind(g(e)),bindPage:o,bindAll:d.bindAll,filters:l.filters,sorts:l.sorts,searches:l.searches,currentFilters:l.currentFilters,currentSort:l.currentSort,currentSearches:l.currentSearches,isSortable:l.isSortable,isSearchable:l.isSearchable,isMatchable:l.isMatchable,isFiltering:l.isFiltering,isSorting:l.isSorting,isSearching:l.isSearching,getFilter:l.getFilter,getSort:l.getSort,getSearch:l.getSearch,apply:l.apply,applyFilter:l.applyFilter,applySort:l.applySort,applySearch:l.applySearch,applyMatch:l.applyMatch,clearFilter:l.clearFilter,clearSort:l.clearSort,clearSearch:l.clearSearch,clearMatch:l.clearMatch,reset:l.reset,bindFilter:l.bindFilter,bindSort:l.bindSort,bindSearch:l.bindSearch,bindMatch:l.bindMatch,stringValue:l.stringValue,omitValue:l.omitValue,toggleValue:l.toggleValue,delimitArray:l.delimitArray})}function ae(a,m){return a?typeof a=="object"?a.type===m:a===m:!1}x.is=ae,x.useTable=re,Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})});
