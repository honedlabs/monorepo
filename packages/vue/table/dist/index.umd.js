(function(V,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],c):(V=typeof globalThis<"u"?globalThis:V||self,c(V["@honed/table"]={},V.Vue,V.Inertia))})(this,function(V,c,S){"use strict";function Y(l,f,s,a={}){return l.route?(S.router.visit(l.route.url,{...a,method:l.route.method}),!0):l.action&&f?(S.router.post(f,{...s,name:l.name,type:l.type},a),!0):!1}function Q(l,f,s,a={},p={}){return Y(l,f,{...a,id:s??void 0},p)}function Z(l,f,s,a={}){return l.map(p=>({...p,execute:(o={},i={})=>Q(p,f,s,o,{...a,...i})}))}function _(){const l=c.ref({all:!1,only:new Set,except:new Set});function f(){l.value.all=!0,l.value.only.clear(),l.value.except.clear()}function s(){l.value.all=!1,l.value.only.clear(),l.value.except.clear()}function a(...d){d.forEach(h=>l.value.except.delete(h)),d.forEach(h=>l.value.only.add(h))}function p(...d){d.forEach(h=>l.value.except.add(h)),d.forEach(h=>l.value.only.delete(h))}function o(d,h){if(i(d)||h===!1)return p(d);if(!i(d)||h===!0)return a(d)}function i(d){return l.value.all?!l.value.except.has(d):l.value.only.has(d)}const g=c.computed(()=>l.value.all&&l.value.except.size===0),k=c.computed(()=>l.value.only.size>0||g.value);function x(d){return{"onUpdate:modelValue":h=>{h?a(d):p(d)},modelValue:i(d),value:d}}function w(){return{"onUpdate:modelValue":d=>{d?f():s()},modelValue:g.value}}return{allSelected:g,selection:l,hasSelected:k,selectAll:f,deselectAll:s,select:a,deselect:p,toggle:o,selected:i,bind:x,bindAll:w}}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const X=()=>{};function ee(l,f){function s(...a){return new Promise((p,o)=>{Promise.resolve(l(()=>f.apply(this,a),{fn:f,thisArg:this,args:a})).then(p).catch(o)})}return s}function te(l,f={}){let s,a,p=X;const o=g=>{clearTimeout(g),p(),p=X};let i;return g=>{const k=c.toValue(l),x=c.toValue(f.maxWait);return s&&o(s),k<=0||x!==void 0&&x<=0?(a&&(o(a),a=null),Promise.resolve(g())):new Promise((w,d)=>{p=f.rejectOnCancel?d:w,i=g,x&&!a&&(a=setTimeout(()=>{s&&o(s),a=null,w(i())},x)),s=setTimeout(()=>{a&&o(a),a=null,w(g())},k)})}}function q(l,f=200,s={}){return ee(te(f,s),l)}function ne(l,f,s={}){if(!(l!=null&&l[f]))throw new Error("The refine must be provided with valid props and key.");const a=c.computed(()=>l[f]),p=c.computed(()=>!!a.value.sort),o=c.computed(()=>!!a.value.search),i=c.computed(()=>!!a.value.match),g=c.computed(()=>{var e;return(e=a.value.filters)==null?void 0:e.map(n=>({...n,apply:(r,v={})=>T(n,r,v),clear:(r={})=>B(n,r),bind:()=>H(n.name)}))}),k=c.computed(()=>{var e;return(e=a.value.sorts)==null?void 0:e.map(n=>({...n,apply:(r={})=>A(n,n.direction,r),clear:(r={})=>K(r),bind:()=>t(n)}))}),x=c.computed(()=>{var e;return(e=a.value.searches)==null?void 0:e.map(n=>({...n,apply:(r={})=>$(n,r),clear:(r={})=>$(n,r),bind:()=>m(n)}))}),w=c.computed(()=>g.value.filter(({active:e})=>e)),d=c.computed(()=>k.value.find(({active:e})=>e)),h=c.computed(()=>x.value.filter(({active:e})=>e));function R(e){return Array.isArray(e)?e.join(a.value.delimiter):e}function U(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function j(e){if(!["",null,void 0,[]].includes(e))return e}function z(e){return[R,U,j].reduce((n,r)=>r(n),e)}function G(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(r=>r!==e):[...n,e]}function C(e){return typeof e!="string"?e:g.value.find(({name:n})=>n===e)}function y(e,n=null){return typeof e!="string"?e:k.value.find(({name:r,direction:v})=>r===e&&v===n)}function E(e){return typeof e!="string"?e:x.value.find(({name:n})=>n===e)}function b(e){return e?typeof e=="string"?w.value.some(n=>n.name===e):e.active:!!w.value.length}function I(e){var n;return e?typeof e=="string"?((n=d.value)==null?void 0:n.name)===e:e.active:!!d.value}function F(e){var n;return e?typeof e=="string"?(n=h.value)==null?void 0:n.some(r=>r.name===e):e.active:!!a.value.term}function O(e,n={}){const r=Object.fromEntries(Object.entries(e).map(([v,P])=>[v,z(P)]));S.router.reload({...s,...n,data:r})}function T(e,n,r={}){const v=C(e);if(!v)return console.warn(`Filter [${e}] does not exist.`);S.router.reload({...s,...r,data:{[v.name]:z(n)}})}function A(e,n=null,r={}){if(!p.value)return console.warn("Refine cannot perform sorting.");const v=y(e,n);if(!v)return console.warn(`Sort [${e}] does not exist.`);S.router.reload({...s,...r,data:{[a.value.sort]:j(v.next)}})}function M(e,n={}){if(!o.value)return console.warn("Refine cannot perform searching.");e=[U,j].reduce((r,v)=>v(r),e),S.router.reload({...s,...n,data:{[a.value.search]:e}})}function $(e,n={}){if(!i.value||!o.value)return console.warn("Refine cannot perform matching.");const r=E(e);if(!r)return console.warn(`Match [${e}] does not exist.`);const v=G(r.name,h.value.map(({name:P})=>P));S.router.reload({...s,...n,data:{[a.value.match]:R(v)}})}function B(e,n={}){if(e)return T(e,null,n);S.router.reload({...s,...n,data:Object.fromEntries(w.value.map(({name:r})=>[r,null]))})}function K(e={}){if(!p.value)return console.warn("Refine cannot perform sorting.");S.router.reload({...s,...e,data:{[a.value.sort]:null}})}function J(e={}){M(null,e)}function N(e={}){if(!i.value)return console.warn("Refine cannot perform matching.");S.router.reload({...s,...e,data:{[a.value.match]:null}})}function D(e={}){var n;S.router.reload({...s,...e,data:{[a.value.search??""]:void 0,[a.value.sort??""]:void 0,[a.value.match??""]:void 0,...Object.fromEntries(((n=a.value.filters)==null?void 0:n.map(r=>[r.name,void 0]))??[])}})}function H(e,n={}){const r=C(e);if(!r)return console.warn(`Filter [${e}] does not exist.`);const{debounce:v=250,transform:P=L=>L,...W}=n;return{"onUpdate:modelValue":q(L=>{T(r,P(L),W)},v),modelValue:r.value}}function t(e,n={}){const r=y(e);if(!r)return console.warn(`Sort [${e}] does not exist.`);const{debounce:v=0,transform:P,...W}=n;return{onClick:q(()=>{var L;A(r,(L=d.value)==null?void 0:L.direction,W)},v)}}function u(e={}){const{debounce:n=700,transform:r,...v}=e;return{"onUpdate:modelValue":q(P=>{M(P,v)},n),modelValue:a.value.term??""}}function m(e,n={}){const r=E(e);if(!r)return console.warn(`Match [${e}] does not exist.`);const{debounce:v=0,transform:P,...W}=n;return{"onUpdate:modelValue":q(L=>{$(L,W)},v),modelValue:F(r),value:r.name}}return{filters:g,sorts:k,searches:x,currentFilters:w,currentSort:d,currentSearches:h,isSortable:p,isSearchable:o,isMatchable:i,isFiltering:b,isSorting:I,isSearching:F,getFilter:C,getSort:y,getSearch:E,apply:O,applyFilter:T,applySort:A,applySearch:M,applyMatch:$,clearFilter:B,clearSort:K,clearSearch:J,clearMatch:N,reset:D,bindFilter:H,bindSort:t,bindSearch:u,bindMatch:m,stringValue:U,omitValue:j,toggleValue:G,delimitArray:R}}function le(l,f,s={}){if(!(l!=null&&l[f]))throw new Error("The table must be provided with valid props and key.");const{recordOperations:a={},...p}={only:[...s.only??[],f.toString()],...s},o=c.computed(()=>l[f]),i=_(),g=ne(l,f,p),k=c.computed(()=>o.value.meta),x=c.computed(()=>!!o.value.page&&!!o.value.record),w=c.computed(()=>!!o.value.column),d=c.computed(()=>o.value.columns.filter(({active:t,hidden:u})=>t&&!u).map(t=>{var u;return{...t,isSorting:!!((u=t.sort)!=null&&u.active),toggleSort:(m={})=>g.applySort(t.sort,null,m)}})),h=c.computed(()=>o.value.columns.filter(({hidden:t})=>!t).map(t=>({...t,toggle:(u={})=>J(t.name,u)}))),R=c.computed(()=>o.value.records.map(t=>({operations:T(t.operations),default:(u={})=>{const m=t.operations.find(({default:e})=>e);m&&M(m,t,u)},select:()=>i.select(b(t)),deselect:()=>i.deselect(b(t)),toggle:()=>i.toggle(b(t)),selected:i.selected(b(t)),bind:()=>i.bind(b(t)),entry:u=>F(t,u),value:u=>{var m;return((m=F(t,u))==null?void 0:m.v)??null},extra:u=>{var m;return((m=F(t,u))==null?void 0:m.e)??null}}))),U=c.computed(()=>!!o.value.operations.inline),j=c.computed(()=>T(o.value.operations.bulk)),z=c.computed(()=>T(o.value.operations.page)),G=c.computed(()=>o.value.pages.find(({active:t})=>t)),C=c.computed(()=>o.value.pages),y=c.computed(()=>({...o.value.paginate,next:(t={})=>{"nextLink"in y.value&&y.value.nextLink&&A(y.value.nextLink,t)},previous:(t={})=>{"prevLink"in y.value&&y.value.prevLink&&A(y.value.prevLink,t)},first:(t={})=>{"firstLink"in y.value&&y.value.firstLink&&A(y.value.firstLink,t)},last:(t={})=>{"lastLink"in y.value&&y.value.lastLink&&A(y.value.lastLink,t)},..."links"in o.value.paginate&&o.value.paginate.links?{links:o.value.paginate.links.map(t=>({...t,navigate:(u={})=>t.url&&A(t.url,u)}))}:{}})),E=c.computed(()=>o.value.records.length>0&&o.value.records.every(t=>i.selected(b(t))));function b(t){return t[o.value.key].v}function I(t){return typeof t=="string"?t:t.name}function F(t,u){const m=I(u);return m in t?t[m]:null}function O(t,u={},m={}){return Q(t,o.value.endpoint,o.value.id,u,{...p,...m})}function T(t){return Z(t,o.value.endpoint,o.value.id,p)}function A(t,u={}){S.router.visit(t,{preserveScroll:!0,preserveState:!0,...p,...u,method:"get"})}function M(t,u,m={}){var n;O(t,{record:b(u)},m)||(n=a==null?void 0:a[t.name])==null||n.call(a,u)}function $(t,u={}){O(t,{all:i.selection.value.all,only:Array.from(i.selection.value.only),except:Array.from(i.selection.value.except)},{...u,onSuccess:m=>{var e;(e=u.onSuccess)==null||e.call(u,m),t.keepSelected||i.deselectAll()}})}function B(t,u={},m={}){return O(t,u,m)}function K(t,u={}){if(!x.value)return console.warn("The table does not support pagination changes.");S.router.reload({...p,...u,data:{[o.value.record]:t.value,[o.value.page]:void 0}})}function J(t,u={}){if(!w.value)return console.warn("The table does not support column toggling.");const m=I(t);if(!m)return console.log(`Column [${t}] does not exist.`);const e=g.toggleValue(m,d.value.map(({name:n})=>n));S.router.reload({...p,...u,data:{[o.value.column]:g.delimitArray(e)}})}function N(){i.select(...o.value.records.map(t=>b(t)))}function D(){i.deselect(...o.value.records.map(t=>b(t)))}function H(){return{"onUpdate:modelValue":t=>{t?N():D()},modelValue:E.value}}return c.reactive({meta:k,isPageable:x,isToggleable:w,getRecordKey:b,headings:d,columns:h,records:R,inline:U,bulk:j,page:z,pages:C,currentPage:G,paginator:y,executeInline:M,executeBulk:$,executePage:B,applyPage:K,selection:i.selection,select:t=>i.select(b(t)),deselect:t=>i.deselect(b(t)),selectPage:N,deselectPage:D,toggle:t=>i.toggle(b(t)),selected:t=>i.selected(b(t)),selectAll:i.selectAll,deselectAll:i.deselectAll,isPageSelected:E,hasSelected:i.hasSelected,bindCheckbox:t=>i.bind(b(t)),bindPage:H,bindAll:i.bindAll,...g})}function ae(l,f){return l?typeof l=="object"?l.type===f:l===f:!1}V.is=ae,V.useTable=le,Object.defineProperty(V,Symbol.toStringTag,{value:"Module"})});
