(function(A,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("vue"),require("@inertiajs/vue3"),require("axios")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3","axios"],s):(A=typeof globalThis<"u"?globalThis:A||self,s(A["@honed/table"]={},A.Vue,A.Inertia,A.axios))})(this,function(A,s,b,te){"use strict";function ne(l,f,d,o={}){if(l.route){const{url:r,method:u}=l.route;return l.inertia?window.location.href=r:b.router.visit(r,{...o,method:u}),!0}if(!l.action||!f)return!1;const m={...d,name:l.name,type:l.type};return l.inertia?b.router.post(f,m,o):te.post(f,m).catch(r=>{var u;return(u=o.onError)==null?void 0:u.call(o,r)}),!0}function _(l,f,d,o={},m={}){return ne(l,f,{...o,id:d??void 0},m)}function re(l,f,d,o={},m={}){return l.map(r=>({...r,execute:(u={},a={})=>_(r,f,d,{...m,...u},{...o,...a})}))}function ae(){const l=s.ref({all:!1,only:new Set,except:new Set});function f(){l.value.all=!0,l.value.only.clear(),l.value.except.clear()}function d(){l.value.all=!1,l.value.only.clear(),l.value.except.clear()}function o(...p){p.forEach(y=>l.value.except.delete(y)),p.forEach(y=>l.value.only.add(y))}function m(...p){p.forEach(y=>l.value.except.add(y)),p.forEach(y=>l.value.only.delete(y))}function r(p,y){if(u(p)||y===!1)return m(p);if(!u(p)||y===!0)return o(p)}function u(p){return l.value.all?!l.value.except.has(p):l.value.only.has(p)}const a=s.computed(()=>l.value.all&&l.value.except.size===0),x=s.computed(()=>l.value.only.size>0||a.value);function w(p){return{"onUpdate:modelValue":y=>{y?o(p):m(p)},modelValue:u(p),value:p}}function V(){return{"onUpdate:modelValue":p=>{p?f():d()},modelValue:a.value}}return{allSelected:a,selection:l,hasSelected:x,selectAll:f,deselectAll:d,select:o,deselect:m,toggle:r,selected:u,bind:w,bindAll:V}}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ee=()=>{};function le(l,f){function d(...o){return new Promise((m,r)=>{Promise.resolve(l(()=>f.apply(this,o),{fn:f,thisArg:this,args:o})).then(m).catch(r)})}return d}function oe(l,f={}){let d,o,m=ee;const r=a=>{clearTimeout(a),m(),m=ee};let u;return a=>{const x=s.toValue(l),w=s.toValue(f.maxWait);return d&&r(d),x<=0||w!==void 0&&w<=0?(o&&(r(o),o=null),Promise.resolve(a())):new Promise((V,p)=>{m=f.rejectOnCancel?p:V,u=a,w&&!o&&(o=setTimeout(()=>{d&&r(d),o=null,V(u())},w)),d=setTimeout(()=>{o&&r(o),o=null,V(a())},x)})}}function I(l,f=200,d={}){return le(oe(f,d),l)}function ie(l,f,d={}){if(!(l!=null&&l[f]))throw new Error("The refine must be provided with valid props and key.");const o=s.computed(()=>l[f]),m=s.computed(()=>!!o.value.sort),r=s.computed(()=>!!o.value.search),u=s.computed(()=>!!o.value.match),a=s.computed(()=>{var t;return(t=o.value.filters)==null?void 0:t.map(n=>({...n,apply:(i,v={})=>E(n,i,v),clear:(i={})=>$(n,i),bind:()=>U(n.name)}))}),x=s.computed(()=>{var t;return(t=o.value.sorts)==null?void 0:t.map(n=>({...n,apply:(i={})=>R(n,n.direction,i),clear:(i={})=>B(i),bind:()=>P(n)}))}),w=s.computed(()=>{var t;return(t=o.value.searches)==null?void 0:t.map(n=>({...n,apply:(i={})=>F(n,i),clear:(i={})=>F(n,i),bind:()=>N(n)}))}),V=s.computed(()=>a.value.filter(({active:t})=>t)),p=s.computed(()=>x.value.find(({active:t})=>t)),y=s.computed(()=>w.value.filter(({active:t})=>t));function C(t){return Array.isArray(t)?t.join(o.value.delimiter):t}function j(t){return typeof t!="string"?t:t.trim().replace(/\s+/g,"+")}function M(t){if(!["",null,void 0,[]].includes(t))return t}function O(t){return[C,j,M].reduce((n,i)=>i(n),t)}function K(t,n){return n=Array.isArray(n)?n:[n],n.includes(t)?n.filter(i=>i!==t):[...n,t]}function q(t){return typeof t!="string"?t:a.value.find(({name:n})=>n===t)}function W(t,n=null){return typeof t!="string"?t:x.value.find(({name:i,direction:v})=>i===t&&v===n)}function z(t){return typeof t!="string"?t:w.value.find(({name:n})=>n===t)}function Y(t){return t?typeof t=="string"?V.value.some(n=>n.name===t):t.active:!!V.value.length}function Q(t){var n;return t?typeof t=="string"?((n=p.value)==null?void 0:n.name)===t:t.active:!!p.value}function D(t){var n;return t?typeof t=="string"?(n=y.value)==null?void 0:n.some(i=>i.name===t):t.active:!!o.value.term}function S(t,n={}){const i=Object.fromEntries(Object.entries(t).map(([v,k])=>[v,O(k)]));b.router.reload({...d,...n,data:i})}function E(t,n,i={}){const v=q(t);if(!v)return console.warn(`Filter [${t}] does not exist.`);b.router.reload({...d,...i,data:{[v.name]:O(n)}})}function R(t,n=null,i={}){if(!m.value)return console.warn("Refine cannot perform sorting.");const v=W(t,n);if(!v)return console.warn(`Sort [${t}] does not exist.`);b.router.reload({...d,...i,data:{[o.value.sort]:M(v.next)}})}function h(t,n={}){if(!r.value)return console.warn("Refine cannot perform searching.");t=[j,M].reduce((i,v)=>v(i),t),b.router.reload({...d,...n,data:{[o.value.search]:t}})}function F(t,n={}){if(!u.value||!r.value)return console.warn("Refine cannot perform matching.");const i=z(t);if(!i)return console.warn(`Match [${t}] does not exist.`);const v=K(i.name,y.value.map(({name:k})=>k));b.router.reload({...d,...n,data:{[o.value.match]:C(v)}})}function $(t,n={}){if(t)return E(t,null,n);b.router.reload({...d,...n,data:Object.fromEntries(V.value.map(({name:i})=>[i,null]))})}function B(t={}){if(!m.value)return console.warn("Refine cannot perform sorting.");b.router.reload({...d,...t,data:{[o.value.sort]:null}})}function Z(t={}){h(null,t)}function H(t={}){if(!u.value)return console.warn("Refine cannot perform matching.");b.router.reload({...d,...t,data:{[o.value.match]:null}})}function G(t={}){var n;b.router.reload({...d,...t,data:{[o.value.search??""]:void 0,[o.value.sort??""]:void 0,[o.value.match??""]:void 0,...Object.fromEntries(((n=o.value.filters)==null?void 0:n.map(i=>[i.name,void 0]))??[])}})}function U(t,n={}){const i=q(t);if(!i)return console.warn(`Filter [${t}] does not exist.`);const{debounce:v=150,transform:k=e=>e,...T}=n;return{"onUpdate:modelValue":I(e=>{E(i,k(e),T)},v),modelValue:i.value}}function P(t,n={}){if(!m.value)return console.warn("Refine cannot perform sorting.");const i=W(t);if(!i)return console.warn(`Sort [${t}] does not exist.`);const{debounce:v=0,transform:k,...T}=n;return{onClick:I(()=>{var e;R(i,(e=p.value)==null?void 0:e.direction,T)},v)}}function J(t={}){if(!r.value)return console.warn("Refine cannot perform searching.");const{debounce:n=700,transform:i,...v}=t;return{"onUpdate:modelValue":I(k=>{h(k,v)},n),modelValue:o.value.term??""}}function N(t,n={}){if(!u.value)return console.warn("Refine cannot perform matching.");const i=z(t);if(!i)return console.warn(`Match [${t}] does not exist.`);const{debounce:v=0,transform:k,...T}=n;return{"onUpdate:modelValue":I(e=>{F(e,T)},v),modelValue:D(i),value:i.name}}return s.reactive({filters:a,sorts:x,searches:w,currentFilters:V,currentSort:p,currentSearches:y,isSortable:m,isSearchable:r,isMatchable:u,isFiltering:Y,isSorting:Q,isSearching:D,getFilter:q,getSort:W,getSearch:z,apply:S,applyFilter:E,applySort:R,applySearch:h,applyMatch:F,clearFilter:$,clearSort:B,clearSearch:Z,clearMatch:H,reset:G,bindFilter:U,bindSort:P,bindSearch:J,bindMatch:N,stringValue:j,omitValue:M,toggleValue:K,delimitArray:C})}function ue(l,f,d={}){if(!(l!=null&&l[f]))throw new Error("The table must be provided with valid props and key.");const{recordOperations:o={},...m}={only:[...d.only??[],f.toString()],...d},r=s.computed(()=>l[f]),u=ae(),a=ie(l,f,m),x=s.computed(()=>r.value.id??null),w=s.computed(()=>r.value.meta),V=s.computed(()=>r.value.views??[]),p=s.computed(()=>r.value.emptyState??null),y=s.computed(()=>r.value.placeholder??null),C=s.computed(()=>!!r.value.emptyState),j=s.computed(()=>!!r.value.page&&!!r.value.record),M=s.computed(()=>!!r.value.column),O=s.computed(()=>r.value.columns.filter(({active:e,hidden:c})=>e&&!c).map(e=>{var c;return{...e,isSorting:!!((c=e.sort)!=null&&c.active),toggleSort:(g={})=>a.applySort(e.sort,null,g)}})),K=s.computed(()=>r.value.columns.filter(({hidden:e})=>!e).map(e=>({...e,toggle:(c={})=>i(e.name,c)}))),q=s.computed(()=>r.value.records.map(e=>({operations:U(e.operations,Z(e)),class:e.class??null,default:(c={})=>{const g=e.operations.find(({default:L})=>L);g&&J(g,e,c)},select:()=>u.select(h(e)),deselect:()=>u.deselect(h(e)),toggle:()=>u.toggle(h(e)),selected:u.selected(h(e)),bind:()=>u.bind(h(e)),entry:c=>F(e,c),value:c=>$(e,c),extra:c=>B(e,c)}))),W=s.computed(()=>!!r.value.operations.inline),z=s.computed(()=>U(r.value.operations.bulk,H())),Y=s.computed(()=>U(r.value.operations.page)),Q=s.computed(()=>r.value.pages.find(({active:e})=>e)),D=s.computed(()=>r.value.pages),S=s.computed(()=>({...r.value.paginate,next:(e={})=>{"nextLink"in S.value&&S.value.nextLink&&P(S.value.nextLink,e)},previous:(e={})=>{"prevLink"in S.value&&S.value.prevLink&&P(S.value.prevLink,e)},first:(e={})=>{"firstLink"in S.value&&S.value.firstLink&&P(S.value.firstLink,e)},last:(e={})=>{"lastLink"in S.value&&S.value.lastLink&&P(S.value.lastLink,e)},..."links"in r.value.paginate&&r.value.paginate.links?{links:r.value.paginate.links.map(e=>({...e,navigate:(c={})=>e.url&&P(e.url,c)}))}:{}})),E=s.computed(()=>r.value.records.length>0&&r.value.records.every(e=>u.selected(h(e))));function R(e){return typeof e=="string"?e:e.name}function h(e){return"value"in e&&typeof e.value=="function"?e.value(r.value.key):$(e,r.value.key)}function F(e,c){const g=R(c);return g in e&&g!=="classes"?e[g]:null}function $(e,c){var g;return((g=F(e,c))==null?void 0:g.v)??null}function B(e,c){var g;return(g=F(e,c))==null?void 0:g.e}function Z(e){return{record:h(e)}}function H(){return{all:u.selection.value.all,only:Array.from(u.selection.value.only),except:Array.from(u.selection.value.except)}}function G(e,c={},g={}){return _(e,r.value.endpoint,x.value,c,{...m,...g})}function U(e,c={}){return re(e,r.value.endpoint,x.value,m,c)}function P(e,c={}){b.router.visit(e,{preserveScroll:!0,preserveState:!0,...m,...c,method:"get"})}function J(e,c,g={}){var X;G(e,{record:h(c)},g)||(X=o==null?void 0:o[e.name])==null||X.call(o,c)}function N(e,c={}){G(e,H(),{...c,onSuccess:g=>{var L;(L=c.onSuccess)==null||L.call(c,g),e.keepSelected||u.deselectAll()}})}function t(e,c={},g={}){return G(e,c,g)}function n(e,c={}){if(!j.value)return console.warn("The table does not support pagination changes.");b.router.reload({...m,...c,data:{[r.value.record]:e.value,[r.value.page]:void 0}})}function i(e,c={}){if(!M.value)return console.warn("The table does not support column toggling.");const g=R(e);if(!g)return console.log(`Column [${e}] does not exist.`);const L=a.toggleValue(g,O.value.map(({name:X})=>X));b.router.reload({...m,...c,data:{[r.value.column]:a.delimitArray(L)}})}function v(){u.select(...r.value.records.map(e=>h(e)))}function k(){u.deselect(...r.value.records.map(e=>h(e)))}function T(){return{"onUpdate:modelValue":e=>{e?v():k()},modelValue:E.value}}return s.reactive({id:x,meta:w,views:V,emptyState:p,placeholder:y,isEmpty:C,isPageable:j,isToggleable:M,getEntry:F,getValue:$,getExtra:B,getRecordKey:h,headings:O,columns:K,records:q,inline:W,bulk:z,page:Y,pages:D,currentPage:Q,paginator:S,executeInline:J,executeBulk:N,executePage:t,applyPage:n,selection:u.selection,select:e=>u.select(h(e)),deselect:e=>u.deselect(h(e)),selectPage:v,deselectPage:k,toggle:e=>u.toggle(h(e)),selected:e=>u.selected(h(e)),selectAll:u.selectAll,deselectAll:u.deselectAll,isPageSelected:E,hasSelected:u.hasSelected,bindCheckbox:e=>u.bind(h(e)),bindPage:T,bindAll:u.bindAll,filters:a.filters,sorts:a.sorts,searches:a.searches,currentFilters:a.currentFilters,currentSort:a.currentSort,currentSearches:a.currentSearches,isSortable:a.isSortable,isSearchable:a.isSearchable,isMatchable:a.isMatchable,isFiltering:a.isFiltering,isSorting:a.isSorting,isSearching:a.isSearching,getFilter:a.getFilter,getSort:a.getSort,getSearch:a.getSearch,apply:a.apply,applyFilter:a.applyFilter,applySort:a.applySort,applySearch:a.applySearch,applyMatch:a.applyMatch,clearFilter:a.clearFilter,clearSort:a.clearSort,clearSearch:a.clearSearch,clearMatch:a.clearMatch,reset:a.reset,bindFilter:a.bindFilter,bindSort:a.bindSort,bindSearch:a.bindSearch,bindMatch:a.bindMatch,stringValue:a.stringValue,omitValue:a.omitValue,toggleValue:a.toggleValue,delimitArray:a.delimitArray})}function ce(l,f){return l?typeof l=="object"?l.type===f:l===f:!1}A.is=ce,A.useTable=ue,Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})});
