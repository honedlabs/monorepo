(function(A,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],c):(A=typeof globalThis<"u"?globalThis:A||self,c(A["@honed/table"]={},A.Vue,A.Inertia))})(this,function(A,c,b){"use strict";function D(){const o=c.ref({all:!1,only:new Set,except:new Set});function v(){o.value.all=!0,o.value.only.clear(),o.value.except.clear()}function d(){o.value.all=!1,o.value.only.clear(),o.value.except.clear()}function l(...u){u.forEach(p=>o.value.except.delete(p)),u.forEach(p=>o.value.only.add(p))}function a(...u){u.forEach(p=>o.value.except.add(p)),u.forEach(p=>o.value.only.delete(p))}function i(u,p){if(h(u)||p===!1)return a(u);if(!h(u)||p===!0)return l(u)}function h(u){return o.value.all?!o.value.except.has(u):o.value.only.has(u)}const f=c.computed(()=>o.value.all&&o.value.except.size===0),y=c.computed(()=>o.value.only.size>0||f.value);function x(u){return{"onUpdate:modelValue":p=>{console.log("Checked:",p),p?l(u):a(u)},modelValue:h(u),value:u}}function S(){return{"onUpdate:modelValue":u=>{console.log("Checked:",u),u?v():d()},modelValue:f.value}}return{allSelected:f,selection:o,hasSelected:y,selectAll:v,deselectAll:d,select:l,deselect:a,toggle:i,selected:h,bind:x,bindAll:S}}function W(o,v,d={},l={}){return o.route?(b.router.visit(o.route.href,{...l,method:o.route.method}),!0):o.action&&v?(b.router.post(v,{...d,name:o.name,type:o.type},l),!0):!1}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const R=()=>{};function M(o,v){function d(...l){return new Promise((a,i)=>{Promise.resolve(o(()=>v.apply(this,l),{fn:v,thisArg:this,args:l})).then(a).catch(i)})}return d}function _(o,v={}){let d,l,a=R;const i=f=>{clearTimeout(f),a(),a=R};let h;return f=>{const y=c.toValue(o),x=c.toValue(v.maxWait);return d&&i(d),y<=0||x!==void 0&&x<=0?(l&&(i(l),l=null),Promise.resolve(f())):new Promise((S,u)=>{a=v.rejectOnCancel?u:S,h=f,x&&!l&&(l=setTimeout(()=>{d&&i(d),l=null,S(h())},x)),d=setTimeout(()=>{l&&i(l),l=null,S(f())},y)})}}function B(o,v=200,d={}){return M(_(v,d),o)}function H(o,v,d={}){const l=c.computed(()=>o[v]),a=c.computed(()=>l.value.filters.map(e=>({...e,apply:(n,r={})=>V(e,n,r),clear:(n={})=>U(e,n),bind:()=>j(e.name)}))),i=c.computed(()=>l.value.sorts.map(e=>({...e,apply:(n={})=>T(e,e.direction,n),clear:(n={})=>$(n),bind:()=>z(e)})));function h(e){return Array.isArray(e)?e.join(l.value.config.delimiter):e}function f(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function y(e){if(!["",null,void 0,[]].includes(e))return e}function x(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(r=>r!==e):[...n,e]}function S(e,n=null){return l.value.sorts.find(r=>r.name===e&&r.direction===n)}function u(e){return l.value.filters.find(n=>n.name===e)}function p(e){var n;return(n=l.value.searches)==null?void 0:n.find(r=>r.name===e)}function L(){return l.value.sorts.find(({active:e})=>e)}function w(){return l.value.filters.filter(({active:e})=>e)}function m(){var e;return((e=l.value.searches)==null?void 0:e.filter(({active:n})=>n))??[]}function E(e){var n;return e?((n=L())==null?void 0:n.name)===e:!!L()}function g(e){return e?w().some(n=>n.name===e):!!w().length}function P(e){var n,r;return e?(n=m())==null?void 0:n.some(s=>s.name===e):!!((r=m())!=null&&r.length)}function V(e,n,r={}){const s=typeof e=="string"?u(e):e;if(!s){console.warn(`Filter [${e}] does not exist.`);return}"multiple"in s&&s.multiple&&(n=x(n,s.value)),n=[h,f,y].reduce((k,C)=>C(k),n),console.log(n),b.router.reload({...d,...r,data:{[s.name]:n}})}function T(e,n=null,r={}){const s=typeof e=="string"?S(e,n):e;if(!s){console.warn(`Sort [${e}] does not exist.`);return}b.router.reload({...d,...r,data:{[l.value.config.sorts]:y(s.next)}})}function F(e,n={}){e=[f,y].reduce((r,s)=>s(r),e),b.router.reload({...d,...n,data:{[l.value.config.searches]:e}})}function U(e,n={}){V(e,void 0,n)}function $(e={}){b.router.reload({...d,...e,data:{[l.value.config.sorts]:null}})}function G(e={}){F(void 0,e)}function q(e={}){b.router.reload({...d,...e,data:{[l.value.config.searches]:void 0,[l.value.config.sorts]:void 0,...Object.fromEntries(l.value.filters.map(n=>[n.name,void 0])),...l.value.config.matches?{[l.value.config.matches]:void 0}:{}}})}function j(e,n={}){const r=typeof e=="string"?u(e):e;if(!r){console.warn(`Filter [${e}] does not exist.`);return}const s=r.value,{debounce:k=250,transform:C=K=>K,...I}=n;return{"onUpdate:modelValue":B(K=>{V(r,C(K),I)},k),modelValue:s,value:s}}function z(e,n={}){const r=typeof e=="string"?S(e):e;if(!r){console.warn(`Sort [${e}] does not exist.`);return}const{debounce:s=0,transform:k,...C}=n;return{onClick:B(()=>{var I;T(r,(I=L())==null?void 0:I.direction,C)},s)}}function t(e={}){const{debounce:n=700,transform:r,...s}=e;return{"onUpdate:modelValue":B(k=>{F(k,s)},n),modelValue:l.value.config.search??""}}return{filters:a,sorts:i,getSort:S,getFilter:u,getSearch:p,currentSort:L,currentFilters:w,currentSearches:m,isSorting:E,isFiltering:g,isSearching:P,applyFilter:V,applySort:T,applySearch:F,clearFilter:U,clearSort:$,clearSearch:G,reset:q,bindFilter:j,bindSort:z,bindSearch:t,stringValue:f,omitValue:y,toggleValue:x,delimitArray:h}}function J(o,v,d={},l={}){l={...l,only:[...l.only??[],v.toString()]};const a=c.computed(()=>o[v]),i=D(),h=H(o,v,l),f=c.computed(()=>a.value.config),y=c.computed(()=>a.value.columns.filter(({active:t,hidden:e})=>t&&!e).map(t=>({...t,applySort:(e={})=>$(t,e)}))),x=c.computed(()=>a.value.columns.filter(({hidden:t})=>!t).map(t=>({...t,toggleColumn:(e={})=>G(t,e)}))),S=c.computed(()=>a.value.records.map(t=>({...t,default:(e={})=>{const n=t.actions.find(r=>r.default);n&&V(n,t,e)},actions:t.actions.map(e=>({...e,execute:(n={})=>V(e,t,n)})),select:()=>i.select(g(t)),deselect:()=>i.deselect(g(t)),toggle:()=>i.toggle(g(t)),selected:i.selected(g(t)),bind:()=>i.bind(g(t))}))),u=c.computed(()=>a.value.actions.bulk.map(t=>({...t,execute:(e={})=>T(t,e)}))),p=c.computed(()=>a.value.actions.page.map(t=>({...t,execute:(e={})=>F(t,e)}))),L=c.computed(()=>a.value.recordsPerPage.map(t=>({...t,apply:(e={})=>U(t,e)}))),w=c.computed(()=>a.value.recordsPerPage.find(({active:t})=>t)),m=c.computed(()=>({...a.value.paginator,next:(t={})=>{"nextLink"in m.value&&m.value.nextLink&&P(m.value.nextLink,t)},previous:(t={})=>{"prevLink"in m.value&&m.value.prevLink&&P(m.value.prevLink,t)},first:(t={})=>{"firstLink"in m.value&&m.value.firstLink&&P(m.value.firstLink,t)},last:(t={})=>{"lastLink"in m.value&&m.value.lastLink&&P(m.value.lastLink,t)},..."links"in a.value.paginator&&a.value.paginator.links?{links:a.value.paginator.links.map(t=>({...t,navigate:(e={})=>t.url&&P(t.url,e)}))}:{}})),E=c.computed(()=>a.value.records.length>0&&a.value.records.every(t=>i.selected(g(t))));function g(t){return t[f.value.record]}function P(t,e={}){b.router.visit(t,{...l,...e,preserveState:!0,method:"get"})}function V(t,e,n={}){var s,k;W(t,f.value.endpoint,{table:a.value.id,id:g(e)},n)||(k=(s=d.recordActions)==null?void 0:s[t.name])==null||k.call(s,e)}function T(t,e={}){W(t,f.value.endpoint,{table:a.value.id,all:i.selection.value.all,only:Array.from(i.selection.value.only),except:Array.from(i.selection.value.except)},e)}function F(t,e={}){W(t,f.value.endpoint,{table:a.value.id},e)}function U(t,e={}){b.router.reload({...l,...e,data:{[f.value.records]:t.value,[f.value.pages]:void 0}})}function $(t,e={}){t.sort&&b.router.reload({...l,...e,data:{[f.value.sorts]:h.omitValue(t.sort.next)}})}function G(t,e={}){const n=h.toggleValue(t.name,y.value.map(({name:r})=>r));b.router.reload({...l,...e,data:{[f.value.columns]:h.delimitArray(n)}})}function q(){i.select(...a.value.records.map(t=>g(t)))}function j(){i.deselect(...a.value.records.map(t=>g(t)))}function z(){return{"onUpdate:modelValue":t=>{t?q():j()},modelValue:E.value}}return c.reactive({headings:y,columns:x,records:S,bulkActions:u,pageActions:p,rowsPerPage:L,currentPage:w,paginator:m,isPageSelected:E,selectPage:q,deselectPage:j,selection:i.selection,select:t=>i.select(g(t)),deselect:t=>i.deselect(g(t)),toggle:t=>i.toggle(g(t)),selected:t=>i.selected(g(t)),hasSelected:i.hasSelected,bindPage:z,bind:t=>i.bind(g(t)),...h})}A.useTable=J,Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})});
