(function(d,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],u):(d=typeof globalThis<"u"?globalThis:d||self,u(d["@honed/refine"]={},d.Vue,d.Inertia))})(this,function(d,u,l){"use strict";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const E=()=>{};function B(y,s){function i(...r){return new Promise((f,c)=>{Promise.resolve(y(()=>s.apply(this,r),{fn:s,thisArg:this,args:r})).then(f).catch(c)})}return i}function H(y,s={}){let i,r,f=E;const c=b=>{clearTimeout(b),f(),f=E};let g;return b=>{const x=u.toValue(y),p=u.toValue(s.maxWait);return i&&c(i),x<=0||p!==void 0&&p<=0?(r&&(c(r),r=null),Promise.resolve(b())):new Promise((m,S)=>{f=s.rejectOnCancel?S:m,g=b,p&&!r&&(r=setTimeout(()=>{i&&c(i),r=null,m(g())},p)),i=setTimeout(()=>{r&&c(r),r=null,m(b())},x)})}}function w(y,s=200,i={}){return B(H(s,i),y)}function J(y,s,i={}){const r=u.computed(()=>y[s]),f=u.computed(()=>!!r.value.sort),c=u.computed(()=>!!r.value.search),g=u.computed(()=>!!r.value.match),U=u.computed(()=>{var e;return(e=r.value.filters)==null?void 0:e.map(n=>({...n,apply:(t,o={})=>j(n,t,o),clear:(t={})=>D(n,t),bind:()=>I(n.name)}))}),b=u.computed(()=>{var e;return(e=r.value.sorts)==null?void 0:e.map(n=>({...n,apply:(t={})=>P(n,n.direction,t),clear:(t={})=>G(t),bind:()=>_(n)}))}),x=u.computed(()=>{var e;return(e=r.value.searches)==null?void 0:e.map(n=>({...n,apply:(t={})=>F(n,t),clear:(t={})=>F(n,t),bind:()=>z(n)}))});function p(e){return e.filter(({active:n})=>n)}const m=u.computed(()=>p(r.value.filters)),S=u.computed(()=>{var e;return(e=p(r.value.sorts))==null?void 0:e[0]}),O=u.computed(()=>p(r.value.searches));function T(e){return Array.isArray(e)?e.join(r.value.delimiter):e}function R(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function V(e){if(!["",null,void 0,[]].includes(e))return e}function k(e){return[T,R,V].reduce((n,t)=>t(n),e)}function q(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(t=>t!==e):[...n,e]}function M(e){var n;return typeof e!="string"?e:(n=r.value.filters)==null?void 0:n.find(({name:t})=>t===e)}function A(e,n=null){var t;return typeof e!="string"?e:(t=r.value.sorts)==null?void 0:t.find(({name:o,direction:a})=>o===e&&a===n)}function $(e){var n;return typeof e!="string"?e:(n=r.value.searches)==null?void 0:n.find(({name:t})=>t===e)}function K(e){return e?typeof e=="string"?m.value.some(n=>n.name===e):e.active:!!m.value.length}function L(e){var n;return e?typeof e=="string"?((n=S.value)==null?void 0:n.name)===e:e.active:!!S.value}function C(e){var n;return e?typeof e=="string"?(n=O.value)==null?void 0:n.some(t=>t.name===e):e.active:!!r.value.term}function N(e,n={}){const t=Object.fromEntries(Object.entries(e).map(([o,a])=>[o,k(a)]));l.router.reload({...i,...n,data:t})}function j(e,n,t={}){const o=M(e);if(!o)return console.warn(`Filter [${e}] does not exist.`);l.router.reload({...i,...t,data:{[o.name]:k(n)}})}function P(e,n=null,t={}){const o=A(e,n);if(!o)return console.warn(`Sort [${e}] does not exist.`);if(!f.value)return console.warn("Refine cannot perform sorting.");l.router.reload({...i,...t,data:{[r.value.sort]:V(o.next)}})}function W(e,n={}){if(e=[R,V].reduce((t,o)=>o(t),e),!c.value)return console.warn("Refine cannot perform searching.");l.router.reload({...i,...n,data:{[r.value.search]:e}})}function F(e,n={}){const t=$(e);if(!t)return console.warn(`Match [${e}] does not exist.`);if(!g.value||!c.value)return console.warn("Refine cannot perform matching.");const o=q(t.name,O.value.map(({name:a})=>a));l.router.reload({...i,...n,data:{[r.value.match]:T(o)}})}function D(e,n={}){if(e)return j(e,null,n);l.router.reload({...i,...n,data:Object.fromEntries(m.value.map(({name:t})=>[t,null]))})}function G(e={}){if(!f.value)return console.warn("Refine cannot perform sorting.");l.router.reload({...i,...e,data:{[r.value.sort]:null}})}function Q(e={}){W(null,e)}function X(e={}){if(!g.value)return console.warn("Refine cannot perform matching.");l.router.reload({...i,...e,data:{[r.value.match]:null}})}function Y(e={}){var n;l.router.reload({...i,...e,data:{[r.value.search??""]:void 0,[r.value.sort??""]:void 0,[r.value.match??""]:void 0,...Object.fromEntries(((n=r.value.filters)==null?void 0:n.map(t=>[t.name,void 0]))??[])}})}function I(e,n={}){const t=M(e);if(!t)return console.warn(`Filter [${e}] does not exist.`);const{debounce:o=250,transform:a=h=>h,...v}=n;return{"onUpdate:modelValue":w(h=>{j(t,a(h),v)},o),modelValue:t.value}}function _(e,n={}){const t=A(e);if(!t)return console.warn(`Sort [${e}] does not exist.`);const{debounce:o=0,transform:a,...v}=n;return{onClick:w(()=>{var h;P(t,(h=S.value)==null?void 0:h.direction,v)},o)}}function Z(e={}){const{debounce:n=700,transform:t,...o}=e;return{"onUpdate:modelValue":w(a=>{W(a,o)},n),modelValue:r.value.term??""}}function z(e,n={}){const t=$(e);if(!t)return console.warn(`Match [${e}] does not exist.`);const{debounce:o=0,transform:a,...v}=n;return{"onUpdate:modelValue":w(h=>{F(h,v)},o),modelValue:C(t),value:t.name}}return{filters:U,sorts:b,searches:x,currentFilters:m,currentSort:S,currentSearches:O,isSortable:f,isSearchable:c,isMatchable:g,isFiltering:K,isSorting:L,isSearching:C,getFilter:M,getSort:A,getSearch:$,apply:N,applyFilter:j,applySort:P,applySearch:W,applyMatch:F,clearFilter:D,clearSort:G,clearSearch:Q,clearMatch:X,reset:Y,bindFilter:I,bindSort:_,bindSearch:Z,bindMatch:z,stringValue:R,omitValue:V,toggleValue:q,delimitArray:T}}d.useRefine=J,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
