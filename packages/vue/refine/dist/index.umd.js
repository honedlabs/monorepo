(function(s,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],u):(s=typeof globalThis<"u"?globalThis:s||self,u(s["@honed/refine"]={},s.Vue,s.Inertia))})(this,function(s,u,l){"use strict";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const k=()=>{};function O(m,a){function o(...r){return new Promise((g,d)=>{Promise.resolve(m(()=>a.apply(this,r),{fn:a,thisArg:this,args:r})).then(g).catch(d)})}return o}function _(m,a={}){let o,r,g=k;const d=c=>{clearTimeout(c),g(),g=k};let V;return c=>{const h=u.toValue(m),p=u.toValue(a.maxWait);return o&&d(o),h<=0||p!==void 0&&p<=0?(r&&(d(r),r=null),Promise.resolve(c())):new Promise((y,b)=>{g=a.rejectOnCancel?b:y,V=c,p&&!r&&(r=setTimeout(()=>{o&&d(o),r=null,y(V())},p)),o=setTimeout(()=>{r&&d(r),r=null,y(c())},h)})}}function x(m,a=200,o={}){return O(_(a,o),m)}function z(m,a,o={}){const r=u.computed(()=>m[a]),g=u.computed(()=>{var e;return((e=r.value.filters)==null?void 0:e.map(n=>({...n,apply:(t,i={})=>j(n,t,i),clear:(t={})=>C(n,t),bind:()=>E(n.name)})))??[]}),d=u.computed(()=>{var e;return((e=r.value.sorts)==null?void 0:e.map(n=>({...n,apply:(t={})=>$(n,n.direction,t),clear:(t={})=>D(t),bind:()=>G(n)})))??[]}),V=u.computed(()=>{var e;return(e=r.value.searches)==null?void 0:e.map(n=>({...n,apply:(t={})=>w(n,t),clear:(t={})=>w(n,t),bind:()=>I(n)}))}),F=u.computed(()=>{var e;return((e=r.value.filters)==null?void 0:e.filter(({active:n})=>n))??[]}),c=u.computed(()=>{var e;return(e=r.value.sorts)==null?void 0:e.find(({active:n})=>n)}),h=u.computed(()=>{var e;return((e=r.value.searches)==null?void 0:e.filter(({active:n})=>n))??[]});function p(e){return Array.isArray(e)?e.join(r.value.config.delimiter):e}function y(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function b(e){if(!["",null,void 0,[]].includes(e))return e}function R(e){return[p,y,b].reduce((n,t)=>t(n),e)}function U(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(t=>t!==e):[...n,e]}function T(e){var n;return(n=r.value.filters)==null?void 0:n.find(t=>t.name===e)}function M(e,n=null){var t;return(t=r.value.sorts)==null?void 0:t.find(i=>i.name===e&&i.direction===n)}function A(e){var n;return(n=r.value.searches)==null?void 0:n.find(t=>t.name===e)}function B(e){return e?typeof e=="string"?F.value.some(n=>n.name===e):e.active:!!F.value.length}function H(e){var n;return e?typeof e=="string"?((n=c.value)==null?void 0:n.name)===e:e.active:!!c.value}function q(e){var n;return e?typeof e=="string"?(n=h.value)==null?void 0:n.some(t=>t.name===e):e.active:!!r.value.config.term}function J(e,n={}){const t=Object.fromEntries(Object.entries(e).map(([i,f])=>[i,R(f)]));l.router.reload({...o,...n,data:t})}function j(e,n,t={}){const i=typeof e=="string"?T(e):e;if(!i){console.warn(`Filter [${e}] does not exist.`);return}l.router.reload({...o,...t,data:{[i.name]:R(n)}})}function $(e,n=null,t={}){const i=typeof e=="string"?M(e,n):e;if(!i){console.warn(`Sort [${e}] does not exist.`);return}l.router.reload({...o,...t,data:{[r.value.config.sort]:b(i.next)}})}function P(e,n={}){e=[y,b].reduce((t,i)=>i(t),e),l.router.reload({...o,...n,data:{[r.value.config.search]:e}})}function w(e,n={}){const t=typeof e=="string"?A(e):e;if(!t){console.warn(`Match [${e}] does not exist.`);return}const i=U(t.name,h.value.map(({name:f})=>f));l.router.reload({...o,...n,data:{[r.value.config.match]:p(i)}})}function C(e,n={}){j(e,void 0,n)}function D(e={}){l.router.reload({...o,...e,data:{[r.value.config.sort]:void 0}})}function K(e={}){P(void 0,e)}function L(e={}){if(!r.value.config.match){console.warn("Matches key is not set.");return}l.router.reload({...o,...e,data:{[r.value.config.match]:void 0}})}function N(e={}){var n;l.router.reload({...o,...e,data:{[r.value.config.search]:void 0,[r.value.config.sort]:void 0,[r.value.config.match]:void 0,...Object.fromEntries(((n=r.value.filters)==null?void 0:n.map(t=>[t.name,void 0]))??[])}})}function E(e,n={}){const t=typeof e=="string"?T(e):e;if(!t){console.warn(`Filter [${e}] does not exist.`);return}const i=t.value,{debounce:f=250,transform:v=W=>W,...S}=n;return{"onUpdate:modelValue":x(W=>{j(t,v(W),S)},f),modelValue:i}}function G(e,n={}){const t=typeof e=="string"?M(e):e;if(!t){console.warn(`Sort [${e}] does not exist.`);return}const{debounce:i=0,transform:f,...v}=n;return{onClick:x(()=>{var S;$(t,(S=c.value)==null?void 0:S.direction,v)},i)}}function Q(e={}){const{debounce:n=700,transform:t,...i}=e;return{"onUpdate:modelValue":x(f=>{P(f,i)},n),modelValue:r.value.config.term??""}}function I(e,n={}){const t=typeof e=="string"?A(e):e;if(!t){console.warn(`Match [${e}] does not exist.`);return}const{debounce:i=0,transform:f,...v}=n;return{"onUpdate:modelValue":x(S=>{w(S,v)},i),modelValue:q(t),value:t.name}}return{filters:g,sorts:d,searches:V,getFilter:T,getSort:M,getSearch:A,currentFilters:F,currentSort:c,currentSearches:h,isFiltering:B,isSorting:H,isSearching:q,apply:J,applyFilter:j,applySort:$,applySearch:P,applyMatch:w,clearFilter:C,clearSort:D,clearSearch:K,clearMatch:L,reset:N,bindFilter:E,bindSort:G,bindSearch:Q,bindMatch:I,stringValue:y,omitValue:b,toggleValue:U,delimitArray:p}}s.useRefine=z,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
