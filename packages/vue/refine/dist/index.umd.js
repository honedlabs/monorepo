(function(s,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],u):(s=typeof globalThis<"u"?globalThis:s||self,u(s["@honed/refine"]={},s.Vue,s.Inertia))})(this,function(s,u,d){"use strict";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const W=()=>{};function z(a,c){function i(...r){return new Promise((f,l)=>{Promise.resolve(a(()=>c.apply(this,r),{fn:c,thisArg:this,args:r})).then(f).catch(l)})}return i}function B(a,c={}){let i,r,f=W;const l=m=>{clearTimeout(m),f(),f=W};let b;return m=>{const v=u.toValue(a),p=u.toValue(c.maxWait);return i&&l(i),v<=0||p!==void 0&&p<=0?(r&&(l(r),r=null),Promise.resolve(m())):new Promise((g,w)=>{f=c.rejectOnCancel?w:g,b=m,p&&!r&&(r=setTimeout(()=>{i&&l(i),r=null,g(b())},p)),i=setTimeout(()=>{r&&l(r),r=null,g(m())},v)})}}function j(a,c=200,i={}){return z(B(c,i),a)}function H(a,c,i={}){if(!(a!=null&&a[c]))throw new Error("The refine must be provided with valid props and key.");const r=u.computed(()=>a[c]),f=u.computed(()=>!!r.value.sort),l=u.computed(()=>!!r.value.search),b=u.computed(()=>!!r.value.match),V=u.computed(()=>{var e;return(e=r.value.filters)==null?void 0:e.map(n=>({...n,apply:(t,o={})=>F(n,t,o),clear:(t={})=>C(n,t),bind:()=>G(n.name)}))}),m=u.computed(()=>{var e;return(e=r.value.sorts)==null?void 0:e.map(n=>({...n,apply:(t={})=>P(n,n.direction,t),clear:(t={})=>D(t),bind:()=>I(n)}))}),v=u.computed(()=>{var e;return(e=r.value.searches)==null?void 0:e.map(n=>({...n,apply:(t={})=>R(n,t),clear:(t={})=>R(n,t),bind:()=>_(n)}))}),p=u.computed(()=>V.value.filter(({active:e})=>e)),g=u.computed(()=>m.value.find(({active:e})=>e)),w=u.computed(()=>v.value.filter(({active:e})=>e));function O(e){return Array.isArray(e)?e.join(r.value.delimiter):e}function T(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function x(e){if(!["",null,void 0,[]].includes(e))return e}function U(e){return[O,T,x].reduce((n,t)=>t(n),e)}function k(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(t=>t!==e):[...n,e]}function M(e){return typeof e!="string"?e:V.value.find(({name:n})=>n===e)}function A(e,n=null){return typeof e!="string"?e:m.value.find(({name:t,direction:o})=>t===e&&o===n)}function $(e){return typeof e!="string"?e:v.value.find(({name:n})=>n===e)}function K(e){return e?typeof e=="string"?p.value.some(n=>n.name===e):e.active:!!p.value.length}function L(e){var n;return e?typeof e=="string"?((n=g.value)==null?void 0:n.name)===e:e.active:!!g.value}function q(e){var n;return e?typeof e=="string"?(n=w.value)==null?void 0:n.some(t=>t.name===e):e.active:!!r.value.term}function N(e,n={}){const t=Object.fromEntries(Object.entries(e).map(([o,h])=>[o,U(h)]));d.router.reload({...i,...n,data:t})}function F(e,n,t={}){const o=M(e);if(!o)return console.warn(`Filter [${e}] does not exist.`);d.router.reload({...i,...t,data:{[o.name]:U(n)}})}function P(e,n=null,t={}){if(!f.value)return console.warn("Refine cannot perform sorting.");const o=A(e,n);if(!o)return console.warn(`Sort [${e}] does not exist.`);d.router.reload({...i,...t,data:{[r.value.sort]:x(o.next)}})}function E(e,n={}){if(!l.value)return console.warn("Refine cannot perform searching.");e=[T,x].reduce((t,o)=>o(t),e),d.router.reload({...i,...n,data:{[r.value.search]:e}})}function R(e,n={}){if(!b.value||!l.value)return console.warn("Refine cannot perform matching.");const t=$(e);if(!t)return console.warn(`Match [${e}] does not exist.`);const o=k(t.name,w.value.map(({name:h})=>h));d.router.reload({...i,...n,data:{[r.value.match]:O(o)}})}function C(e,n={}){if(e)return F(e,null,n);d.router.reload({...i,...n,data:Object.fromEntries(p.value.map(({name:t})=>[t,null]))})}function D(e={}){if(!f.value)return console.warn("Refine cannot perform sorting.");d.router.reload({...i,...e,data:{[r.value.sort]:null}})}function Q(e={}){E(null,e)}function X(e={}){if(!b.value)return console.warn("Refine cannot perform matching.");d.router.reload({...i,...e,data:{[r.value.match]:null}})}function Y(e={}){var n;d.router.reload({...i,...e,data:{[r.value.search??""]:void 0,[r.value.sort??""]:void 0,[r.value.match??""]:void 0,...Object.fromEntries(((n=r.value.filters)==null?void 0:n.map(t=>[t.name,void 0]))??[])}})}function G(e,n={}){const t=M(e);if(!t)return console.warn(`Filter [${e}] does not exist.`);const{debounce:o=150,transform:h=y=>y,...S}=n;return{"onUpdate:modelValue":j(y=>{F(t,h(y),S)},o),modelValue:t.value}}function I(e,n={}){if(!f.value)return console.warn("Refine cannot perform sorting.");const t=A(e);if(!t)return console.warn(`Sort [${e}] does not exist.`);const{debounce:o=0,transform:h,...S}=n;return{onClick:j(()=>{var y;P(t,(y=g.value)==null?void 0:y.direction,S)},o)}}function Z(e={}){if(!l.value)return console.warn("Refine cannot perform searching.");const{debounce:n=700,transform:t,...o}=e;return{"onUpdate:modelValue":j(h=>{E(h,o)},n),modelValue:r.value.term??""}}function _(e,n={}){if(!b.value)return console.warn("Refine cannot perform matching.");const t=$(e);if(!t)return console.warn(`Match [${e}] does not exist.`);const{debounce:o=0,transform:h,...S}=n;return{"onUpdate:modelValue":j(y=>{R(y,S)},o),modelValue:q(t),value:t.name}}return u.reactive({filters:V,sorts:m,searches:v,currentFilters:p,currentSort:g,currentSearches:w,isSortable:f,isSearchable:l,isMatchable:b,isFiltering:K,isSorting:L,isSearching:q,getFilter:M,getSort:A,getSearch:$,apply:N,applyFilter:F,applySort:P,applySearch:E,applyMatch:R,clearFilter:C,clearSort:D,clearSearch:Q,clearMatch:X,reset:Y,bindFilter:G,bindSort:I,bindSearch:Z,bindMatch:_,stringValue:T,omitValue:x,toggleValue:k,delimitArray:O})}function J(a,c){return a?typeof a=="object"?(a==null?void 0:a.type)===c:a===c:!1}s.is=J,s.useRefine=H,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
