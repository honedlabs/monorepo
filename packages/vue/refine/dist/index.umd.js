(function(f,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],u):(f=typeof globalThis<"u"?globalThis:f||self,u(f["@honed/refine"]={},f.Vue,f.Inertia))})(this,function(f,u,s){"use strict";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const E=()=>{};function B(a,c){function i(...r){return new Promise((d,l)=>{Promise.resolve(a(()=>c.apply(this,r),{fn:c,thisArg:this,args:r})).then(d).catch(l)})}return i}function H(a,c={}){let i,r,d=E;const l=m=>{clearTimeout(m),d(),d=E};let b;return m=>{const _=u.toValue(a),y=u.toValue(c.maxWait);return i&&l(i),_<=0||y!==void 0&&y<=0?(r&&(l(r),r=null),Promise.resolve(m())):new Promise((h,v)=>{d=c.rejectOnCancel?v:h,b=m,y&&!r&&(r=setTimeout(()=>{i&&l(i),r=null,h(b())},y)),i=setTimeout(()=>{r&&l(r),r=null,h(m())},_)})}}function k(a,c=200,i={}){return B(H(c,i),a)}function J(a,c,i={}){if(!(a!=null&&a[c]))throw new Error("The refine must be provided with valid props and key.");const r=u.computed(()=>a[c]),d=u.computed(()=>r.value.term),l=u.computed(()=>!!r.value._sort_key),b=u.computed(()=>!!r.value._search_key),w=u.computed(()=>!!r.value._match_key),m=u.computed(()=>{var e;return(e=r.value.filters)==null?void 0:e.map(n=>({...n,apply:(t,o={})=>V(n,t,o),clear:(t={})=>C(n,t),bind:()=>G(n.name)}))}),_=u.computed(()=>{var e;return(e=r.value.sorts)==null?void 0:e.map(n=>({...n,apply:(t={})=>$(n,n.direction,t),clear:(t={})=>D(t),bind:()=>I(n)}))}),y=u.computed(()=>{var e;return(e=r.value.searches)==null?void 0:e.map(n=>({...n,apply:(t={})=>x(n,t),clear:(t={})=>x(n,t),bind:()=>z(n)}))}),h=u.computed(()=>m.value.filter(({active:e})=>e)),v=u.computed(()=>_.value.find(({active:e})=>e)),F=u.computed(()=>y.value.filter(({active:e})=>e));function R(e){return Array.isArray(e)?e.join(r.value._delimiter):e}function T(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function j(e){if(!["",null,void 0,[]].includes(e))return e}function W(e){return[R,T,j].reduce((n,t)=>t(n),e)}function U(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(t=>t!==e):[...n,e]}function O(e){return typeof e!="string"?e:m.value.find(({name:n})=>n===e)}function M(e,n=null){return typeof e!="string"?e:_.value.find(({name:t,direction:o})=>t===e&&o===n)}function A(e){return typeof e!="string"?e:y.value.find(({name:n})=>n===e)}function L(e){return e?typeof e=="string"?h.value.some(n=>n.name===e):e.active:!!h.value.length}function N(e){var n;return e?typeof e=="string"?((n=v.value)==null?void 0:n.name)===e:e.active:!!v.value}function q(e){var n;return e?typeof e=="string"?(n=F.value)==null?void 0:n.some(t=>t.name===e):e.active:!!d.value}function Q(e,n={}){const t=Object.fromEntries(Object.entries(e).map(([o,p])=>[o,W(p)]));s.router.reload({...i,...n,data:t})}function V(e,n,t={}){const o=O(e);if(!o)return console.warn(`Filter [${e}] does not exist.`);s.router.reload({...i,...t,data:{[o.name]:W(n)}})}function $(e,n=null,t={}){if(!l.value)return console.warn("Refine cannot perform sorting.");const o=M(e,n);if(!o)return console.warn(`Sort [${e}] does not exist.`);s.router.reload({...i,...t,data:{[r.value._sort_key]:j(o.next)}})}function P(e,n={}){if(!b.value)return console.warn("Refine cannot perform searching.");e=[T,j].reduce((t,o)=>o(t),e),s.router.reload({...i,...n,data:{[r.value._search_key]:e}})}function x(e,n={}){if(!w.value||!b.value)return console.warn("Refine cannot perform matching.");const t=A(e);if(!t)return console.warn(`Match [${e}] does not exist.`);const o=U(t.name,F.value.map(({name:p})=>p));s.router.reload({...i,...n,data:{[r.value._match_key]:R(o)}})}function C(e,n={}){if(e)return V(e,null,n);s.router.reload({...i,...n,data:Object.fromEntries(h.value.map(({name:t})=>[t,null]))})}function D(e={}){if(!l.value)return console.warn("Refine cannot perform sorting.");s.router.reload({...i,...e,data:{[r.value._sort_key]:null}})}function X(e={}){P(null,e)}function Y(e={}){if(!w.value)return console.warn("Refine cannot perform matching.");s.router.reload({...i,...e,data:{[r.value._match_key]:null}})}function Z(e={}){var n;s.router.reload({...i,...e,data:{[r.value._search_key??""]:void 0,[r.value._sort_key??""]:void 0,[r.value._match_key??""]:void 0,...Object.fromEntries(((n=r.value.filters)==null?void 0:n.map(t=>[t.name,void 0]))??[])}})}function G(e,n={}){const t=O(e);if(!t)return console.warn(`Filter [${e}] does not exist.`);const{debounce:o=150,transform:p=g=>g,...S}=n;return{"onUpdate:modelValue":k(g=>{V(t,p(g),S)},o),modelValue:t.value}}function I(e,n={}){if(!l.value)return console.warn("Refine cannot perform sorting.");const t=M(e);if(!t)return console.warn(`Sort [${e}] does not exist.`);const{debounce:o=0,transform:p,...S}=n;return{onClick:k(()=>{var g;$(t,(g=v.value)==null?void 0:g.direction,S)},o)}}function ee(e={}){if(!b.value)return console.warn("Refine cannot perform searching.");const{debounce:n=700,transform:t,...o}=e;return{"onUpdate:modelValue":k(p=>{P(p,o)},n),modelValue:d.value??""}}function z(e,n={}){if(!w.value)return console.warn("Refine cannot perform matching.");const t=A(e);if(!t)return console.warn(`Match [${e}] does not exist.`);const{debounce:o=0,transform:p,...S}=n;return{"onUpdate:modelValue":k(g=>{x(g,S)},o),modelValue:q(t),value:t.name}}return{filters:m,sorts:_,searches:y,currentFilters:h,currentSort:v,currentSearches:F,searchTerm:d,isSortable:l,isSearchable:b,isMatchable:w,isFiltering:L,isSorting:N,isSearching:q,getFilter:O,getSort:M,getSearch:A,apply:Q,applyFilter:V,applySort:$,applySearch:P,applyMatch:x,clearFilter:C,clearSort:D,clearSearch:X,clearMatch:Y,reset:Z,bindFilter:G,bindSort:I,bindSearch:ee,bindMatch:z,stringValue:T,omitValue:j,toggleValue:U,delimitArray:R}}function K(a,c){return a?typeof a=="object"?(a==null?void 0:a.type)===c:a===c:!1}f.is=K,f.useRefine=J,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
