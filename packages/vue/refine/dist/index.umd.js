(function(f,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue"),require("@inertiajs/vue3")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiajs/vue3"],u):(f=typeof globalThis<"u"?globalThis:f||self,u(f["@honed/refine"]={},f.Vue,f.Inertia))})(this,function(f,u,l){"use strict";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const q=()=>{};function O(p,s){function o(...r){return new Promise((m,d)=>{Promise.resolve(p(()=>s.apply(this,r),{fn:s,thisArg:this,args:r})).then(m).catch(d)})}return o}function _(p,s={}){let o,r,m=q;const d=a=>{clearTimeout(a),m(),m=q};let w;return a=>{const g=u.toValue(p),h=u.toValue(s.maxWait);return o&&d(o),g<=0||h!==void 0&&h<=0?(r&&(d(r),r=null),Promise.resolve(a())):new Promise((y,S)=>{m=s.rejectOnCancel?S:y,w=a,h&&!r&&(r=setTimeout(()=>{o&&d(o),r=null,y(w())},h)),o=setTimeout(()=>{r&&d(r),r=null,y(a())},g)})}}function V(p,s=200,o={}){return O(_(s,o),p)}function z(p,s,o={}){const r=u.computed(()=>p[s]),m=u.computed(()=>r.value.filters.map(e=>({...e,apply:(n,t={})=>M(e,n,t),clear:(n={})=>C(e,n),bind:()=>E(e.name)}))),d=u.computed(()=>r.value.sorts.map(e=>({...e,apply:(n={})=>W(e,e.direction,n),clear:(n={})=>D(n),bind:()=>G(e)}))),w=u.computed(()=>{var e;return(e=r.value.searches)==null?void 0:e.map(n=>({...n,apply:(t={})=>v(n,t),clear:(t={})=>v(n,t),bind:()=>I(n)}))});function F(e){return Array.isArray(e)?e.join(r.value.config.delimiter):e}function a(e){return typeof e!="string"?e:e.trim().replace(/\s+/g,"+")}function g(e){if(!["",null,void 0,[]].includes(e))return e}function h(e){return[F,a,g].reduce((n,t)=>t(n),e)}function y(e,n){return n=Array.isArray(n)?n:[n],n.includes(e)?n.filter(t=>t!==e):[...n,e]}function S(e){return r.value.filters.find(n=>n.name===e)}function A(e,n=null){return r.value.sorts.find(t=>t.name===e&&t.direction===n)}function $(e){var n;return(n=r.value.searches)==null?void 0:n.find(t=>t.name===e)}function P(){return r.value.filters.filter(({active:e})=>e)}function j(){return r.value.sorts.find(({active:e})=>e)}function T(){var e;return((e=r.value.searches)==null?void 0:e.filter(({active:n})=>n))??[]}function B(e){return e?typeof e=="string"?P().some(n=>n.name===e):e.active:!!P().length}function H(e){var n;return e?typeof e=="string"?((n=j())==null?void 0:n.name)===e:e.active:!!j()}function k(e){var n,t;return e?typeof e=="string"?(t=T())==null?void 0:t.some(i=>i.name===e):e.active:!!((n=T())!=null&&n.length)}function J(e,n={}){const t=Object.fromEntries(Object.entries(e).map(([i,c])=>[i,h(c)]));l.router.reload({...o,...n,data:t})}function M(e,n,t={}){const i=typeof e=="string"?S(e):e;if(!i){console.warn(`Filter [${e}] does not exist.`);return}"multiple"in i&&i.multiple&&(n=y(n,i.value)),l.router.reload({...o,...t,data:{[i.name]:h(n)}})}function W(e,n=null,t={}){const i=typeof e=="string"?A(e,n):e;if(!i){console.warn(`Sort [${e}] does not exist.`);return}l.router.reload({...o,...t,data:{[r.value.config.sorts]:g(i.next)}})}function R(e,n={}){e=[a,g].reduce((t,i)=>i(t),e),l.router.reload({...o,...n,data:{[r.value.config.searches]:e}})}function v(e,n={}){if(!r.value.config.matches){console.warn("Matches key is not set.");return}if(!(typeof e=="string"?$(e):e)){console.warn(`Match [${e}] does not exist.`);return}const i=y(e,T().filter(({active:c})=>c).map(({name:c})=>c));l.router.reload({...o,...n,data:{[r.value.config.matches]:F(i)}})}function C(e,n={}){M(e,void 0,n)}function D(e={}){l.router.reload({...o,...e,data:{[r.value.config.sorts]:null}})}function K(e={}){R(void 0,e)}function L(e={}){if(!r.value.config.matches){console.warn("Matches key is not set.");return}l.router.reload({...o,...e,data:{[r.value.config.matches]:null}})}function N(e={}){l.router.reload({...o,...e,data:{[r.value.config.searches]:void 0,[r.value.config.sorts]:void 0,...Object.fromEntries(r.value.filters.map(n=>[n.name,void 0])),...r.value.config.matches?{[r.value.config.matches]:void 0}:{}}})}function E(e,n={}){const t=typeof e=="string"?S(e):e;if(!t){console.warn(`Filter [${e}] does not exist.`);return}const i=t.value,{debounce:c=250,transform:x=U=>U,...b}=n;return{"onUpdate:modelValue":V(U=>{M(t,x(U),b)},c),modelValue:i,value:i}}function G(e,n={}){const t=typeof e=="string"?A(e):e;if(!t){console.warn(`Sort [${e}] does not exist.`);return}const{debounce:i=0,transform:c,...x}=n;return{onClick:V(()=>{var b;W(t,(b=j())==null?void 0:b.direction,x)},i)}}function Q(e={}){const{debounce:n=700,transform:t,...i}=e;return{"onUpdate:modelValue":V(c=>{R(c,i)},n),modelValue:r.value.config.search??"",value:r.value.config.search??""}}function I(e,n={}){const t=typeof e=="string"?$(e):e;if(!t){console.warn(`Match [${e}] does not exist.`);return}const{debounce:i=0,transform:c,...x}=n;return{"onUpdate:modelValue":V(b=>{v(b,x)},i),modelValue:k(t),value:k(t)}}return{filters:m,sorts:d,searches:w,getFilter:S,getSort:A,getSearch:$,currentFilters:P,currentSort:j,currentSearches:T,isFiltering:B,isSorting:H,isSearching:k,apply:J,applyFilter:M,applySort:W,applySearch:R,applyMatch:v,clearFilter:C,clearSort:D,clearSearch:K,clearMatch:L,reset:N,bindFilter:E,bindSort:G,bindSearch:Q,bindMatch:I,stringValue:a,omitValue:g,toggleValue:y,delimitArray:F}}f.useRefine=z,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
